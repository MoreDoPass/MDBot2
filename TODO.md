V. Переход на отдельный навигационный сервис (NavService) — План работ
1. Архитектура и подготовка
[ ] 1.1. Создать новый проект NavService
[ ] Разместить в tools/NavService/ (или tools/NavmeshNavigation/ — выбрать финальное имя)
[ ] Сборка только в x64 (64-бит)
[ ] Минимальный CMake/VS проект, только консольное приложение
[ ] 1.2. Определить протокол обмена
[ ] Описать структуру запроса и ответа (например, JSON или бинарный struct)
[ ] Протокол: Named Pipes (Windows) — \\.\pipe\MDBotNavService
2. Реализация NavService
[ ] 2.1. Импортировать/скопировать код навигации
[ ] Перенести логику загрузки NavMesh, поиска пути, преобразования координат из текущего NavMeshManager/Pathfinder
[ ] Минимизировать зависимости (только Recast/Detour, минимум Qt)
[ ] 2.2. Реализовать сервер Named Pipe
[ ] Ожидание подключения клиента
[ ] Чтение запроса, выполнение поиска пути, отправка ответа
[ ] 2.3. Логирование и обработка ошибок
[ ] Подробные логи (QLoggingCategory или std::cout)
[ ] Обработка невалидных запросов, ошибок загрузки тайлов и т.д.
3. Изменения в основном боте (MDBot2)
[ ] 3.1. Реализовать клиент Named Pipe
[ ] Подключение к \\.\pipe\MDBotNavService
[ ] Формирование и отправка запроса на поиск пути
[ ] Получение и разбор ответа
[ ] 3.2. Удалить/заменить старую логику PathfindingService/NavMeshManager
[ ] Вся логика поиска пути теперь через IPC
[ ] Оставить только код для отправки запроса и применения результата
[ ] 3.3. Обработка ошибок и fallback
[ ] Если сервис не запущен — выводить ошибку пользователю
[ ] Возможность переподключения
4. Тестирование и отладка
[ ] 4.1. Юнит-тесты NavService
[ ] Тесты на загрузку navmesh, поиск простых маршрутов
[ ] 4.2. Интеграционные тесты
[ ] Проверить end-to-end: бот → сервис → бот
[ ] Проверить работу с разными картами, большими маршрутами
[ ] 4.3. Логирование и профилирование
[ ] Оценить скорость, стабильность, нагрузку
5. Документация
[ ] 5.1. README по запуску NavService
[ ] Как собрать, как запускать, параметры командной строки
[ ] 5.2. Описание протокола
[ ] Формат сообщений, примеры, возможные ошибки